<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Meta Financeira Uber ğŸ’°</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
*{box-sizing:border-box}
body{margin:0;font-family:Poppins;background:#0f2027;color:#fff}
.hidden{display:none}
.app{display:flex;min-height:100vh}
.sidebar{width:240px;background:#111;padding:20px}
.sidebar h2{margin:0 0 20px;font-size:20px;text-align:center}
.sidebar button{width:100%;margin-bottom:10px;padding:12px;border:none;border-radius:10px;font-size:15px;cursor:pointer;background:#1f4068;color:#fff}
.sidebar button:hover{background:#2a6fdb}
.main{flex:1;padding:20px}
.tabs{display:flex;gap:10px;margin-bottom:15px}
.tabs button{flex:1;padding:10px;border:none;border-radius:10px;background:#1f4068;color:#fff;font-weight:600}
.card{background:#fff;color:#000;padding:20px;border-radius:16px;margin-bottom:15px}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}
.stat{background:#f1f3f6;border-radius:12px;padding:15px;text-align:center}
.stat strong{display:block;font-size:20px;margin-top:5px}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border-bottom:1px solid #ddd;padding:8px;text-align:center}
th{background:#eee}
input,select{width:100%;padding:10px;margin-top:5px;border-radius:8px;border:1px solid #ccc}
button.action{background:#27ae60;color:#fff;border:none;padding:12px;border-radius:10px;font-weight:600;margin-top:10px;cursor:pointer}
@media(max-width:900px){.app{flex-direction:column}.sidebar{width:100%;display:flex;gap:10px;overflow:auto}}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox" class="card" style="max-width:400px;margin:40px auto">
<h2>ğŸ” Login</h2>
<input id="loginUser" placeholder="UsuÃ¡rio">
<input id="loginPass" type="password" placeholder="Senha">
<button class="action" onclick="login()">Entrar</button>
<button onclick="mostrarCadastro()">ğŸ“ Cadastrar</button>
<button onclick="resetSenha()">ğŸ”„ Resetar senha</button>
<p id="loginMsg"></p>
</div>

<!-- CADASTRO -->
<div id="cadastroBox" class="card hidden" style="max-width:400px;margin:40px auto">
<h2>ğŸ“ Cadastro</h2>
<input id="cadUser" placeholder="UsuÃ¡rio">
<input id="cadNome" placeholder="Nome completo">
<input id="cadTel" placeholder="Celular">
<input id="cadEmail" placeholder="E-mail">
<input id="cadPass" type="password" placeholder="Senha">
<button class="action" onclick="cadastrar()">Cadastrar</button>
<button onclick="voltarLogin()">â¬… Voltar</button>
<p id="cadMsg"></p>
</div>

<!-- APP -->
<div id="app" class="app hidden">

<div class="sidebar">
<h2>ğŸ’° Meta Uber</h2>
<button onclick="mostrarResumo()">ğŸ“Š Resumo</button>
<button onclick="mostrarGraficos()">ğŸ“ˆ GrÃ¡ficos</button>
<button onclick="mostrarHistorico()">ğŸ—‚ï¸ HistÃ³rico</button>
<button onclick="logout()">ğŸšª Sair</button>
</div>

<div class="main">

<div id="resumo">
<div class="stats">
<div class="stat">Total Parcial<strong id="totalParcial">0</strong></div>
<div class="stat">Falta p/ Meta<strong id="faltaMeta">0</strong></div>
<div class="stat">Meta DiÃ¡ria Hoje<strong id="metaHoje">0</strong></div>
<div class="stat">Meta PrÃ³x. Dias<strong id="metaProx">0</strong></div>
</div>
</div>

<div id="graficos" class="hidden card">
<canvas id="grafico"></canvas>
</div>

<div id="historico" class="hidden card">
<h3>ğŸ—‚ï¸ HistÃ³rico</h3>
<table id="tabela"></table>
<button onclick="exportarExcel()">ğŸ“¤ Exportar Excel</button>
<button onclick="exportarPDF()">ğŸ“„ Exportar PDF</button>
</div>

</div>
</div>

<script>
let usuarioLogado=null;

function mostrarCadastro(){loginBox.classList.add('hidden');cadastroBox.classList.remove('hidden')}
function voltarLogin(){cadastroBox.classList.add('hidden');loginBox.classList.remove('hidden')}

function cadastrar(){
const u=cadUser.value;
let users=JSON.parse(localStorage.getItem('users')||'{}');
if(users[u]){cadMsg.innerText='UsuÃ¡rio jÃ¡ existe';return}
users[u]={senha:cadPass.value,dados:[]};
localStorage.setItem('users',JSON.stringify(users));
cadMsg.innerText='Cadastro realizado';}

function login(){
let users=JSON.parse(localStorage.getItem('users')||'{}');
if(users[loginUser.value]?.senha===loginPass.value){usuarioLogado=loginUser.value;loginBox.classList.add('hidden');app.classList.remove('hidden');carregar();}
else loginMsg.innerText='Login invÃ¡lido';}

function resetSenha(){
let u=loginUser.value;
let users=JSON.parse(localStorage.getItem('users')||'{}');
if(users[u]){users[u].senha='9999';localStorage.setItem('users',JSON.stringify(users));loginMsg.innerText='Senha redefinida para 9999';}}

function logout(){location.reload()}

function mostrarResumo(){resumo.classList.remove('hidden');graficos.classList.add('hidden');historico.classList.add('hidden')}
function mostrarGraficos(){resumo.classList.add('hidden');graficos.classList.remove('hidden');historico.classList.add('hidden')}
function mostrarHistorico(){resumo.classList.add('hidden');graficos.classList.add('hidden');historico.classList.remove('hidden')}

function carregar(){atualizarResumo();desenharGrafico();renderTabela()}

function atualizarResumo(){
let users=JSON.parse(localStorage.getItem('users'));
let dados=users[usuarioLogado].dados||[];
let total=dados.reduce((s,d)=>s+d.valor,0);
totalParcial.innerText='R$ '+total.toFixed(2);
faltaMeta.innerText='R$ '+(1500-total).toFixed(2);
metaHoje.innerText='R$ 200';
metaProx.innerText='R$ '+((1500-total)/5).toFixed(2);
}

function desenharGrafico(){
let ctx=grafico.getContext('2d');
let users=JSON.parse(localStorage.getItem('users'));
let dados=users[usuarioLogado].dados||[];
new Chart(ctx,{type:'bar',data:{labels:dados.map(d=>d.data),datasets:[{data:dados.map(d=>d.valor)}]}})}

function renderTabela(){
let users=JSON.parse(localStorage.getItem('users'));
let dados=users[usuarioLogado].dados||[];
tabela.innerHTML='<tr><th>Data</th><th>Valor</th></tr>';
dados.forEach(d=>{tabela.innerHTML+=`<tr><td>${d.data}</td><td>${d.valor}</td></tr>`})}

function exportarExcel(){
let wb=XLSX.utils.book_new();
let ws=XLSX.utils.table_to_sheet(tabela);
XLSX.utils.book_append_sheet(wb,ws,'Historico');
XLSX.writeFile(wb,'historico.xlsx')}

function exportarPDF(){
const {jsPDF}=window.jspdf;
let doc=new jsPDF();
doc.text('HistÃ³rico Financeiro',10,10);
doc.save('historico.pdf')}
</script>
</body>
</html>
