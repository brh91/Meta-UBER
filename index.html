<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Meta Financeira Uber</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{box-sizing:border-box;font-family:Poppins,sans-serif}
body{margin:0;min-height:100vh;background:linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),url('https://images.unsplash.com/photo-1604594849809-dfedbc827105?auto=format&fit=crop&w=1600&q=80');background-size:cover;background-position:center;color:#222}
.hidden{display:none}

/* LOGIN */
.login-box{max-width:380px;margin:80px auto;background:#fff;padding:25px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.3)}
.login-box h2{text-align:center;margin-top:0}
.login-box button{margin-top:10px}

/* APP */
.container{display:flex;min-height:100vh}
.sidebar{width:240px;background:#1e3c72;color:#fff;padding:20px;flex-shrink:0}
.sidebar h2{margin-top:0}
.sidebar button{width:100%;margin:6px 0;padding:12px;border:none;border-radius:10px;cursor:pointer;font-weight:600}
.sidebar button:hover{opacity:.9}
.main{flex:1;padding:20px}
.card{background:#fff;border-radius:16px;padding:20px;margin-bottom:15px;box-shadow:0 8px 20px rgba(0,0,0,.15)}
input,button{padding:12px;border-radius:10px;border:1px solid #ccc;width:100%}
button.primary{background:#1e3c72;color:#fff;border:none}

.tabs{margin-bottom:10px}
.tabs button{margin-right:6px}

.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid #ccc;padding:8px;text-align:center}

@media(max-width:900px){
  .container{flex-direction:column}
  .sidebar{width:100%;display:flex;gap:6px;overflow-x:auto}
  .sidebar button{min-width:140px}
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login" class="login-box">
<h2>Login</h2>
<input id="loginUser" placeholder="Usuário">
<input id="loginPass" type="password" placeholder="Senha">
<button class="primary" onclick="login()">Entrar</button>
<button onclick="showRegister()">Cadastrar</button>
<button onclick="showReset()">Esqueci a senha</button>
<p id="loginMsg"></p>
</div>

<!-- REGISTER -->
<div id="register" class="login-box hidden">
<h2>Cadastrar Usuário</h2>
<input id="regUser" placeholder="Usuário">
<input id="regPass" type="password" placeholder="Senha">
<button class="primary" onclick="register()">Cadastrar</button>
<button onclick="backLogin()">Voltar</button>
<p id="regMsg"></p>
</div>

<!-- RESET -->
<div id="reset" class="login-box hidden">
<h2>Resetar Senha</h2>
<input id="resetUser" placeholder="Usuário">
<button class="primary" onclick="resetPassword()">Resetar para 9999</button>
<button onclick="backLogin()">Voltar</button>
<p id="resetMsg"></p>
</div>

<!-- APP -->
<div id="app" class="container hidden">
  <div class="sidebar">
    <h2 id="userLabel"></h2>
    <button onclick="showSection('resumo')">Resumo</button>
    <button onclick="showSection('ganhos')">Ganhos do Dia</button>
    <button onclick="showSection('graficos')">Gráficos</button>
    <button onclick="showSection('historico')">Histórico</button>
    <button onclick="logout()">Sair</button>
  </div>

  <div class="main">

    <div id="resumo" class="card">
      <div class="tabs">
        <button onclick="showResumoTab('info')">Resumo</button>
        <button onclick="showResumoTab('chart')">Gráficos</button>
      </div>
      <div id="resumoInfo"></div>
      <canvas id="resumoChart" class="hidden"></canvas>
    </div>

    <div id="ganhos" class="card hidden">
      <h3>Ganhos do Dia</h3>
      <input type="date" id="dia">
      <input id="manha" placeholder="Manhã">
      <input id="tarde" placeholder="Tarde">
      <input id="noite" placeholder="Noite">
      <input id="extra" placeholder="Gastos Extras">
      <button class="primary" onclick="salvarDia()">Salvar / Atualizar</button>
    </div>

    <div id="graficos" class="card hidden">
      <canvas id="chart"></canvas>
    </div>

    <div id="historico" class="card hidden">
      <table class="table">
        <thead><tr><th>Data</th><th>Lucro</th></tr></thead>
        <tbody id="hist"></tbody>
      </table>
    </div>

  </div>
</div>

<script>
let currentUser=null
function getUsers(){return JSON.parse(localStorage.getItem('users')||'{}')}
function saveUsers(u){localStorage.setItem('users',JSON.stringify(u))}

function login(){const u=loginUser.value,p=loginPass.value;const users=getUsers();if(!users[u]||users[u].pass!==p){loginMsg.innerText='Usuário ou senha inválidos';return;}currentUser=u;localStorage.setItem('session',u);initApp()}
function register(){const u=regUser.value,p=regPass.value;const users=getUsers();if(users[u]){regMsg.innerText='Usuário já existe';return;}users[u]={pass:p,data:{}};saveUsers(users);regMsg.innerText='Usuário criado com sucesso'}
function resetPassword(){const u=resetUser.value;const users=getUsers();if(!users[u]){resetMsg.innerText='Usuário não encontrado';return;}users[u].pass='9999';saveUsers(users);resetMsg.innerText='Sua senha foi redefinida'}
function showRegister(){login.classList.add('hidden');register.classList.remove('hidden')}
function showReset(){login.classList.add('hidden');reset.classList.remove('hidden')}
function backLogin(){register.classList.add('hidden');reset.classList.add('hidden');login.classList.remove('hidden')}

function initApp(){login.classList.add('hidden');register.classList.add('hidden');reset.classList.add('hidden');app.classList.remove('hidden');userLabel.innerText=currentUser;showSection('resumo');renderResumo();renderHistorico();renderGrafico()}

function getData(){const users=getUsers();return users[currentUser].data}
function saveData(d){const users=getUsers();users[currentUser].data=d;saveUsers(users)}

function salvarDia(){const d=dia.value;if(!d)return;const lucro=(+manha.value||0)+(+tarde.value||0)+(+noite.value||0)-(+extra.value||0);const data=getData();data[d]={lucro};saveData(data);renderResumo();renderHistorico();renderGrafico()}

function renderResumo(){const data=getData();let total=0;Object.values(data).forEach(v=>total+=v.lucro);resumoInfo.innerHTML=`<h3>Total Parcial: R$ ${total.toFixed(2)}</h3>`}
function renderHistorico(){const data=getData();hist.innerHTML='';Object.keys(data).forEach(d=>{hist.innerHTML+=`<tr><td>${d}</td><td>${data[d].lucro.toFixed(2)}</td></tr>`})}
function renderGrafico(){const data=getData();const ctx=chart.getContext('2d');if(window.grafico)window.grafico.destroy();window.grafico=new Chart(ctx,{type:'bar',data:{labels:Object.keys(data),datasets:[{label:'Lucro Diário',data:Object.values(data).map(v=>v.lucro)}]}})}

function showResumoTab(tab){resumoInfo.classList.toggle('hidden',tab!=='info');resumoChart.classList.toggle('hidden',tab!=='chart');if(tab==='chart')renderResumoChart()}
function renderResumoChart(){const data=getData();const ctx=resumoChart.getContext('2d');if(window.resChart)window.resChart.destroy();window.resChart=new Chart(ctx,{type:'line',data:{labels:Object.keys(data),datasets:[{label:'Lucro',data:Object.values(data).map(v=>v.lucro)}]}})}

function showSection(id){['resumo','ganhos','graficos','historico'].forEach(s=>document.getElementById(s).classList.add('hidden'));document.getElementById(id).classList.remove('hidden')}
function logout(){localStorage.removeItem('session');location.reload()}

const sess=localStorage.getItem('session');if(sess){currentUser=sess;initApp()}
</script>
</body>
</html>
