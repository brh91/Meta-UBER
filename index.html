<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meta Uber üí∞</title>

  <!-- ================== ESTILOS GERAIS ================== -->
  <style>
    /* RESET */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
      display: flex;
    }

    /* ================== MENU LATERAL ================== */
    aside {
      width: 240px;
      background: rgba(0,0,0,0.35);
      padding: 20px;
      display: none;
      flex-direction: column;
    }

    aside h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    aside button {
      margin: 6px 0;
      padding: 12px;
      border-radius: 8px;
      border: none;
      background: #1f3b5b;
      color: #fff;
      cursor: pointer;
      font-size: 15px;
    }

    aside button:hover { background: #2c5a88; }

    /* ================== CONTE√öDO ================== */
    main {
      flex: 1;
      padding: 20px;
      display: none;
    }

    section { display: none; }
    section.active { display: block; }

    /* ================== CARDS RESUMO ================== */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .card {
      background: rgba(255,255,255,0.15);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.3);
    }

    .card h3 { font-size: 14px; opacity: 0.9; }
    .card p { font-size: 26px; margin-top: 8px; font-weight: bold; }

    /* ================== PROGRESSO ================== */
    .progress {
      width: 100%;
      height: 20px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      overflow: hidden;
      margin-top: 15px;
    }

    .progress div {
      height: 100%;
      background: linear-gradient(90deg,#00ffcc,#00c6ff);
      width: 0%;
    }

    /* ================== FORMUL√ÅRIOS ================== */
    input, select {
      width: 100%;
      padding: 10px;
      margin: 6px 0;
      border-radius: 6px;
      border: none;
    }

    .btn {
      background: #00c6ff;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }

    /* ================== TABELA ================== */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      padding: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
      text-align: center;
    }

    /* ================== LOGIN ================== */
    #loginBox {
      margin: auto;
      background: rgba(255,255,255,0.12);
      padding: 30px;
      border-radius: 12px;
      width: 320px;
    }

    /* ================== RESPONSIVO ================== */
    @media(max-width:768px){
      aside { width: 100px; }
      aside button { font-size: 12px; }
    }
  </style>
</head>
<body>

<!-- ================== LOGIN ================== -->
<div id="loginBox">
  <h2>üîê Login</h2>
  <input id="user" placeholder="Usu√°rio" />
  <input id="pass" type="password" placeholder="Senha" />
  <button class="btn" onclick="login()">Entrar</button>
  <button onclick="register()">Cadastrar</button>
</div>

<!-- ================== MENU ================== -->
<aside id="menu">
  <h2>üí∞ Meta Uber</h2>
  <button onclick="show('resumo')">üìä Resumo</button>
  <button onclick="show('ganhos')">üïí Ganhos do Dia</button>
  <button onclick="show('graficos')">üìà Gr√°ficos</button>
  <button onclick="show('historico')">üìÅ Hist√≥rico</button>
  <button onclick="logout()">üö™ Sair</button>
</aside>

<!-- ================== MAIN ================== -->
<main id="app">

  <!-- ================== RESUMO ================== -->
  <section id="resumo" class="active">
    <div class="cards">
      <div class="card"><h3>Total Acumulado</h3><p id="total">R$ 0</p></div>
      <div class="card"><h3>Falta p/ Meta</h3><p id="falta">R$ 0</p></div>
      <div class="card"><h3>Meta Di√°ria</h3><p id="diaria">R$ 0</p></div>
    </div>
    <div class="progress"><div id="barra"></div></div>
  </section>

  <!-- ================== GANHOS ================== -->
  <section id="ganhos">
    <h2>üïí Ganhos do Dia</h2>
    <input type="date" id="data" />
    <select id="turno">
      <option>Manh√£</option>
      <option>Tarde</option>
      <option>Noite</option>
    </select>
    <input type="number" id="valor" placeholder="Ganho" />
    <input type="number" id="gasto" placeholder="Gastos" />
    <button class="btn" onclick="salvarGanho()">Salvar / Atualizar</button>
  </section>

  <!-- ================== GR√ÅFICOS ================== -->
  <section id="graficos">
    <canvas id="chart"></canvas>
  </section>

  <!-- ================== HIST√ìRICO ================== -->
  <section id="historico">
    <table>
      <thead>
        <tr><th>Data</th><th>Turno</th><th>Ganho</th><th>Gasto</th><th>A√ß√£o</th></tr>
      </thead>
      <tbody id="hist"></tbody>
    </table>
  </section>
</main>

<!-- ================== SCRIPT ================== -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* =====================================================
   SEGURAN√áA B√ÅSICA
   - Dados isolados por usu√°rio
   - Senha armazenada como hash simples
===================================================== */

let currentUser = null;

function hash(t){ return btoa(t); }

function login(){
  const u = user.value, p = pass.value;
  const db = JSON.parse(localStorage.getItem('users')||'{}');
  if(!db[u] || db[u].pass !== hash(p)) return alert('Login inv√°lido');
  currentUser = u;
  iniciar();
}

function register(){
  const u = user.value, p = pass.value;
  const db = JSON.parse(localStorage.getItem('users')||'{}');
  if(db[u]) return alert('Usu√°rio j√° existe');
  db[u] = { pass: hash(p), ganhos: [] };
  localStorage.setItem('users',JSON.stringify(db));
  alert('Cadastrado!');
}

function logout(){ location.reload(); }

function iniciar(){
  loginBox.style.display='none';
  menu.style.display='flex';
  app.style.display='block';
  render();
}

function show(id){ document.querySelectorAll('section').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

/* =====================================================
   GANHOS / CRUD
===================================================== */
function salvarGanho(){
  const d=data.value, t=turno.value, v=+valor.value, g=+gasto.value;
  const db=JSON.parse(localStorage.getItem('users'));
  let arr=db[currentUser].ganhos;
  const i=arr.findIndex(x=>x.data===d && x.turno===t);
  if(i>=0) arr[i]={data:d,turno:t,valor:v,gasto:g}; else arr.push({data:d,turno:t,valor:v,gasto:g});
  localStorage.setItem('users',JSON.stringify(db));
  render();
}

function excluir(i){
  const db=JSON.parse(localStorage.getItem('users'));
  db[currentUser].ganhos.splice(i,1);
  localStorage.setItem('users',JSON.stringify(db));
  render();
}

/* =====================================================
   RENDER
===================================================== */
let chart;
function render(){
  const db=JSON.parse(localStorage.getItem('users'));
  const g=db[currentUser].ganhos;
  hist.innerHTML='';
  let total=0;
  g.forEach((x,i)=>{
    total+=x.valor-x.gasto;
    hist.innerHTML+=`<tr><td>${x.data}</td><td>${x.turno}</td><td>${x.valor}</td><td>${x.gasto}</td><td><button onclick="excluir(${i})">‚ùå</button></td></tr>`;
  });
  totalEl=total;
  document.getElementById('total').innerText='R$ '+total.toFixed(2);

  /* gr√°fico */
  const labels=g.map(x=>x.data+' '+x.turno);
  const data=g.map(x=>x.valor-x.gasto);
  if(chart) chart.destroy();
  chart=new Chart(document.getElementById('chart'),{type:'line',data:{labels,datasets:[{label:'Lucro',data,fill:true}]}});
}
</script>
</body>
</html>
