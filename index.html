<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Meta Uber ğŸ’°</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
*{box-sizing:border-box}
body{margin:0;font-family:Poppins;background:#0f2027;color:#fff}
.hidden{display:none}
.app{display:flex;min-height:100vh}
.sidebar{width:240px;background:#111;padding:20px}
.sidebar h2{margin:0 0 20px;font-size:20px;text-align:center}
.sidebar button{width:100%;margin-bottom:10px;padding:12px;border:none;border-radius:10px;font-size:15px;cursor:pointer;background:#1f4068;color:#fff}
.sidebar button:hover{background:#2a6fdb}
.main{flex:1;padding:20px}
.card{background:#fff;color:#000;padding:20px;border-radius:16px;margin-bottom:15px}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px}
.stat{background:#f1f3f6;border-radius:12px;padding:15px;text-align:center}
.stat strong{display:block;font-size:22px;margin-top:6px}
input{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid #ccc}
button.action{background:#27ae60;color:#fff;border:none;padding:12px;border-radius:10px;font-weight:600;margin-top:10px;cursor:pointer}
button.action:hover{background:#2ecc71}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border-bottom:1px solid #ddd;padding:8px;text-align:center}
th{background:#eee}
@media(max-width:900px){.app{flex-direction:column}.sidebar{width:100%;display:flex;gap:10px;overflow:auto}}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginBox" class="card" style="max-width:400px;margin:40px auto">
<h2>ğŸ” Login</h2>
<input id="loginUser" placeholder="UsuÃ¡rio">
<input id="loginPass" type="password" placeholder="Senha">
<button class="action" onclick="login()">Entrar</button>
<button onclick="mostrarCadastro()">ğŸ“ Cadastrar</button>
<button onclick="resetSenha()">ğŸ”„ Resetar senha</button>
<p id="loginMsg"></p>
</div>

<!-- CADASTRO -->
<div id="cadastroBox" class="card hidden" style="max-width:400px;margin:40px auto">
<h2>ğŸ“ Cadastro</h2>
<input id="cadUser" placeholder="UsuÃ¡rio">
<input id="cadNome" placeholder="Nome completo">
<input id="cadTel" placeholder="Celular">
<input id="cadEmail" placeholder="E-mail">
<input id="cadPass" type="password" placeholder="Senha">
<button class="action" onclick="cadastrar()">Cadastrar</button>
<button onclick="voltarLogin()">â¬… Voltar</button>
<p id="cadMsg"></p>
</div>

<!-- APP -->
<div id="app" class="app hidden">

<div class="sidebar">
<h2>ğŸ’° Meta Uber</h2>
<button onclick="show('config')">âš™ï¸ ConfiguraÃ§Ãµes</button>
<button onclick="show('resumo')">ğŸ“Š Resumo</button>
<button onclick="show('ganhos')">ğŸ’µ Ganhos do Dia</button>
<button onclick="show('graficos')">ğŸ“ˆ GrÃ¡ficos</button>
<button onclick="show('historico')">ğŸ—‚ï¸ HistÃ³rico</button>
<button onclick="logout()">ğŸšª Sair</button>
</div>

<div class="main">

<!-- CONFIG -->
<div id="config" class="card">
<h3>âš™ï¸ ConfiguraÃ§Ãµes da Meta</h3>
<label>Meta total (R$)</label>
<input id="metaTotal" type="number" value="1500">
<label>Data final</label>
<input id="dataFinal" type="date">
<label>Investimento diÃ¡rio (gasolina)</label>
<input id="custoDiario" type="number" value="80">
<button class="action" onclick="salvarConfig()">Salvar ConfiguraÃ§Ãµes</button>
</div>

<!-- RESUMO -->
<div id="resumo" class="hidden">
<div class="stats">
<div class="stat">ğŸ’° Total Parcial<strong id="totalParcial">0</strong></div>
<div class="stat">ğŸ¯ Falta p/ Meta<strong id="faltaMeta">0</strong></div>
<div class="stat">ğŸ”¥ Meta DiÃ¡ria Hoje<strong id="metaHoje">0</strong></div>
<div class="stat">ğŸ“† Meta PrÃ³x. Dias<strong id="metaProx">0</strong></div>
</div>
</div>

<!-- GANHOS -->
<div id="ganhos" class="card hidden">
<h3>ğŸ’µ Ganhos do Dia</h3>
<label>Data</label>
<input id="ganhoData" type="date">
<label>Valor bruto do dia</label>
<input id="ganhoValor" type="number">
<label>Gastos extras (alimentaÃ§Ã£o, etc)</label>
<input id="ganhoExtra" type="number" value="0">
<button class="action" onclick="salvarGanho()">Salvar Dia</button>
</div>

<!-- GRAFICOS -->
<div id="graficos" class="card hidden">
<canvas id="grafico"></canvas>
</div>

<!-- HISTORICO -->
<div id="historico" class="card hidden">
<h3>ğŸ—‚ï¸ HistÃ³rico</h3>
<table id="tabela"></table>
<br>
<button onclick="exportarExcel()">ğŸ“¤ Excel</button>
<button onclick="exportarPDF()">ğŸ“„ PDF</button>
</div>

</div>
</div>

<script>
let usuario=null;

function show(id){document.querySelectorAll('.main>div').forEach(d=>d.classList.add('hidden'));document.getElementById(id).classList.remove('hidden')}

function mostrarCadastro(){loginBox.classList.add('hidden');cadastroBox.classList.remove('hidden')}
function voltarLogin(){cadastroBox.classList.add('hidden');loginBox.classList.remove('hidden')}

function cadastrar(){let u=cadUser.value;let users=JSON.parse(localStorage.getItem('users')||'{}');if(users[u]){cadMsg.innerText='UsuÃ¡rio jÃ¡ existe';return}users[u]={senha:cadPass.value,config:{meta:1500,custo:80,data:''},dados:[]};localStorage.setItem('users',JSON.stringify(users));cadMsg.innerText='Cadastro realizado'}

function login(){let users=JSON.parse(localStorage.getItem('users')||'{}');if(users[loginUser.value]?.senha===loginPass.value){usuario=loginUser.value;loginBox.classList.add('hidden');app.classList.remove('hidden');carregar()}else loginMsg.innerText='Login invÃ¡lido'}

function resetSenha(){let users=JSON.parse(localStorage.getItem('users')||'{}');if(users[loginUser.value]){users[loginUser.value].senha='9999';localStorage.setItem('users',JSON.stringify(users));loginMsg.innerText='Senha redefinida para 9999'}}

function logout(){location.reload()}

function salvarConfig(){let users=JSON.parse(localStorage.getItem('users'));users[usuario].config={meta:+metaTotal.value,custo:+custoDiario.value,data:dataFinal.value};localStorage.setItem('users',JSON.stringify(users));alert('ConfiguraÃ§Ãµes salvas');atualizarResumo()}

function salvarGanho(){let users=JSON.parse(localStorage.getItem('users'));let c=users[usuario].config;let liquido=(+ganhoValor.value-+ganhoExtra.value)-c.custo;users[usuario].dados.push({data:ganhoData.value,valor:liquido});localStorage.setItem('users',JSON.stringify(users));ganhoValor.value=ganhoExtra.value='';atualizarResumo();renderTabela();desenharGrafico()}

function atualizarResumo(){let u=JSON.parse(localStorage.getItem('users'))[usuario];let total=u.dados.reduce((s,d)=>s+d.valor,0);totalParcial.innerText='R$ '+total.toFixed(2);faltaMeta.innerText='R$ '+(u.config.meta-total).toFixed(2);metaHoje.innerText='R$ '+(u.config.meta/10).toFixed(2);metaProx.innerText='R$ '+((u.config.meta-total)/5).toFixed(2)}

function renderTabela(){let u=JSON.parse(localStorage.getItem('users'))[usuario];tabela.innerHTML='<tr><th>Data</th><th>Valor LÃ­quido</th></tr>';u.dados.forEach(d=>tabela.innerHTML+=`<tr><td>${d.data}</td><td>R$ ${d.valor.toFixed(2)}</td></tr>`)}

function desenharGrafico(){let ctx=grafico.getContext('2d');let u=JSON.parse(localStorage.getItem('users'))[usuario];new Chart(ctx,{type:'bar',data:{labels:u.dados.map(d=>d.data),datasets:[{data:u.dados.map(d=>d.valor),backgroundColor:'#2ecc71'}]},options:{responsive:true}})}

function carregar(){let u=JSON.parse(localStorage.getItem('users'))[usuario];metaTotal.value=u.config.meta;custoDiario.value=u.config.custo;dataFinal.value=u.config.data;atualizarResumo();renderTabela();desenharGrafico()}

function exportarExcel(){let wb=XLSX.utils.book_new();let ws=XLSX.utils.table_to_sheet(tabela);XLSX.utils.book_append_sheet(wb,ws,'Historico');XLSX.writeFile(wb,'historico_meta_uber.xlsx')}

function exportarPDF(){const {jsPDF}=window.jspdf;let doc=new jsPDF();doc.text('HistÃ³rico Meta Uber',10,10);doc.save('historico_meta_uber.pdf')}
</script>
</body>
</html>
